# Notify2Discord

Android の通知を Discord Webhook に自動転送するアプリです。  
「短い本文 + 見やすい Embed」を基本に、履歴確認と削除操作をスマホ向けUIで扱いやすくしています。

## 主な機能

### 通知転送
- 通知アクセスを許可した端末通知を Discord へ自動送信
- アプリごとの個別Webhook設定
- 通知テンプレート（`{app}` `{title}` `{text}` `{time}` `{package}`）対応
- Embed送信、画像などの添付抽出に対応

### 転送本文の取得強化
- `MessagingStyle` のメッセージ行を優先取得
- `EXTRA_BIG_TEXT` / `EXTRA_TEXT_LINES` を優先して本文欠落を抑制
- 送信時はDiscord制限内で分割し、過度な省略を避ける

### 履歴画面（LINEライク操作）
- アプリ一覧で未読件数バッジ表示
- アプリ詳細を開くと、そのアプリの未読件数をリセット（履歴データは保持）
- 一覧画面は「編集 + 長押し」で複数アプリの履歴削除
- アプリ詳細画面は「編集 + 長押し」で複数履歴削除、全削除も併用可能
- Androidの戻る操作で詳細→一覧へ戻る挙動に対応
- 転送対象外の通知を「履歴対象」アプリとして保存する運用に対応

### 転送アプリ設定UI
- `通常のみ / すべて / システム` はTopBarの1ボタンで切替
- 転送対象/履歴対象の2系統チェックを1画面で管理
- 一覧スクロール時は「使い方など」カードを自動で隠して表示領域を拡大

### ルール・抑制
- キーワード/正規表現/重要度/チャンネルIDなどのフィルタ
- 重複抑制（本文ハッシュ・同一タイトル）と判定ウィンドウ秒数
- レート制限・連投集約・サイレント時間の設定
- 初心者モード/詳細モード切替

### 設定・保守
- バックアップ/復元（自動・手動）
- 履歴保持期間の設定と期限切れ履歴の削除
- ライト/ダーク/システムテーマ対応
- 各画面カード背景を青テーマに合う水色トーンへ統一
- 画面幅に応じたレスポンシブなボタン配置（狭い端末でも崩れにくい）

### バッテリー管理
- 表示順を「基本情報 → 詳細情報 → 充放電情報 → 劣化推定グラフ → 履歴収集 → 定期送信 → 公称容量」に統一
- 更新操作はTopBarの更新アイコンから実行
- 定期送信は開始時刻（時/分）と間隔を指定可能

## 画面構成
- 履歴: 通知履歴一覧・アプリ別履歴
- 転送アプリ: 転送/履歴対象選択、個別Webhook、システム表示切替
- ルール: テンプレート/フィルタ/重複抑制/集約/時間帯/ルーティング
- 設定: Webhook、バックアップ、テーマ、保持期間、リンク
- バッテリー: 健康推定、履歴グラフ、収集/定期送信、公称容量

## 環境要件

| 項目 | バージョン |
|------|-----------|
| Android | API 34 (Android 14) 以上 |
| JDK | 17 |
| Gradle | プロジェクト付属 wrapper |

## ビルド

```bash
# 例: macOS / Linux
export JAVA_HOME="/path/to/jdk-17"
./gradlew :app:assembleDebug
```

生成物:
`app/build/outputs/apk/debug/app-debug.apk`

## リンク
- [GitHub リポジトリ](https://github.com/contras11/Notify2Discord)
- [個人開発ポータル](https://remudo.com/)
- [X (Twitter)](https://x.com/remudo_)
